Introduction
============
This documenation provides an introduction to the omsi HDF-based data format employed by the OpenMSI project as well as the omsi software stack including: i) the omsi file format API, ii) data analysis API, and iii) other tools and modules included in the omsi software stack

Mass Spectrometry Imaging
-------------------------

Metabolite and protein analysis is vital to understanding the phenotype of a biological sample. Specifically, metabolite levels dynamically vary in response to energy demands, diet, disease, and environment. Typical analysis of metabolite levels begins with homogenization of a sample and the spatial relationships of the biological material are lost. Mass spectrometry imaging of metabolite and protein levels overcomes this limitation by directly measuring the relative abundance of biomolecules and mapping their position. An "image" constitutes a relative abundance map for a given biomolecule and large-numbers of molecules can be imaged simultaneously. While this technique is certainly revolutionary, the in-depth analysis of these datasets often provides a barrier to many researchers. OpenMSI provides a gateway for the management and storage of these datafiles (where each file is the size of a typical hard drive), the visualization of the hyper-dimensional contents of the data, and the statistical analysis of the data.

Mass Spectrometry Imaging (MSI) plays a key role in the study of the metabolism and energetics of cells and cellular communities. Metabolite imaging and metabolomic analysis are used to map the connectivity, dynamics and spatial topography of complex cellular systems. In contrast to optical imaging, using MSI allows us to study large numbers of metabolic compounds in a single image. A mass spectrometry image provides for each pixel information about the entire mass spectrum, which is described by a high-resolution spectrum, currently consisting of up to 200,000 m/z bins. A single high-resolution 2D image slice requires on the order of 50GB and several TB's in 3D. Analysis of extremely large and complex MSI data is challenging from both a computational as well as visualization/analysis point of view. Users often require assistance by experts analysts to explore and analyze their MSI data.

OpenMSI: Science Gateway
------------------------

The goal of OpenMSI is to provide a web-based gateway for management and storage of MSI data, the visualization of the hyper-dimensional contents of the data, and the statistical analysis of the data. Initially the gateway should support basic: i) data browsing capabilities and ii) data analysis and visualization capabilities. The visualization would provide easy-to-use selection capabilities allowing a user to: i) select regions of interest in a two-dimensional visualization of the imaging data and to retrieve and plot the spectra for the selected data portions and ii) to select peaks of interest in a spectrum and display an image showing which portions of the image contain similar features. Even such a simple exploratory tool would be extremely valuable in making the imaging data more accessible to end-users. In the longer term we envision to extend this simple browser step-by-step with more sophisticates analysis and interactions capabilities to support: i) interactive annotation of spectra, ii) execution of computationally intensive analysis tasks on remote parallel compute systems at NERSC, and iii) upload data and analysis results to OpenMSI to facilitate sharing of data/results with the MSI community. Similar to the CXIDB project at NERSC, we plan to us HDF5 to enable efficient and flexible: i) data storage, ii) retrieval of data subsets, iii) storage of meta-data information, and iv) extension of the data to include additional derived data. As part of this project we also plan to investigate the use of HPC to speed-up a select set of compute intensive analysis tasks. Many of the analysis tasks currently performed in serial ---such as peak detection and filtering--- involve large numbers of independent computations (e.g., on a per spectrum basis) and could efficiently utilize parallel compute resources to speed-up the analysis.

OpenMSI: Software Infrastructure
--------------------------------

The OpenMSI software infrastructure described in this document provides the foundations for interacting with and analyzing MSI data. In order to make MSI data accessible, the OpenMSI project has developed a HDF5 data layout scheme designed for MSI data. The data format enables storage of: i) raw MSI data, ii) metadata information about an experiment, sample and instrument, and iii) derived analysis results, in a single HDF5 file. Multiple experiments, each of which may included multiple MSI datasets and derived analysis results, may be stored in the same HDF5 file. 

The OpenMSI software stack is based on Python using the h5py library for interacting with HDF5 files. omsi provides a custom API for reading/writing omsi HDF5 files. The file API employs a similar strucutre as the file format itself with each high-level HDF5 group being represented by a corresponding python class (see ``omsi.dataformat.omsi_file``). The ``omsi.analysis`` package then provides an API for integrating new anlaysis functions with the HDF5 format and the OpenMSI software stack (as well as a series of analysis functions currently available within omis). Additional helpful tools are availabel via the ``omsi.tools`` and ``omsi.viewer`` packages.

